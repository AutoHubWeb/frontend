(()=>{var e={};e.id=178,e.ids=[178],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1085:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>r.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>o,routeModule:()=>h,tree:()=>d}),a(4094),a(7658),a(1930),a(2523);var s=a(3191),i=a(8716),n=a(7922),r=a.n(n),l=a(5231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);a.d(t,c);let d=["",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,4094)),"D:\\TOOL\\AutoHubWeb\\frontend\\src\\app\\profile\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,7658)),"D:\\TOOL\\AutoHubWeb\\frontend\\src\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(a.bind(a,1930)),"D:\\TOOL\\AutoHubWeb\\frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(a.bind(a,2523)),"D:\\TOOL\\AutoHubWeb\\frontend\\src\\app\\not-found.tsx"]}],o=["D:\\TOOL\\AutoHubWeb\\frontend\\src\\app\\profile\\page.tsx"],u="/profile/page",m={require:a,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/profile/page",pathname:"/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7980:(e,t,a)=>{Promise.resolve().then(a.bind(a,6083))},6083:(e,t,a)=>{"use strict";a.d(t,{default:()=>b});var s=a(326),i=a(7577),n=a(3978),r=a(9752),l=a(1664),c=a(1190),d=a(4794),o=a(3594),u=a(4097),m=a(230),h=a(4976),p=a(119),x=a(9635),f=a(2881);let j=(0,f.Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),v=(0,f.Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var N=a(5957),g=a(434);function b(){let{user:e,isAuthenticated:t}=(0,m.aC)(),{toast:a}=(0,u.pm)(),f=(0,h.useQueryClient)(),[b,y]=(0,i.useState)(!1),[w,C]=(0,i.useState)(!1),[P,k]=(0,i.useState)(e?.firstName||""),[S,_]=(0,i.useState)(e?.lastName||""),[D,A]=(0,i.useState)(e?.email||""),[O,T]=(0,i.useState)(""),[H,M]=(0,i.useState)(""),[q,E]=(0,i.useState)(""),L=(0,p.useMutation)({mutationFn:async e=>{let t=await (0,N.Nv)("PATCH","/api/user/profile",e);return await t.json()},onSuccess:e=>{a({title:"Cập nhật th\xe0nh c\xf4ng",description:"Th\xf4ng tin c\xe1 nh\xe2n đ\xe3 được cập nhật."}),f.invalidateQueries({queryKey:["/api/auth/user"]}),y(!1)},onError:e=>{a({title:"Cập nhật thất bại",description:e.message||"C\xf3 lỗi xảy ra khi cập nhật th\xf4ng tin.",variant:"destructive"})}});return((0,p.useMutation)({mutationFn:async e=>{let t=await (0,N.Nv)("PATCH","/api/user/password",e);return await t.json()},onSuccess:()=>{a({title:"Đổi mật khẩu th\xe0nh c\xf4ng",description:"Mật khẩu của bạn đ\xe3 được thay đổi."}),C(!1),T(""),M(""),E("")},onError:e=>{a({title:"Đổi mật khẩu thất bại",description:e.message||"C\xf3 lỗi xảy ra khi đổi mật khẩu.",variant:"destructive"})}}),e)?s.jsx(n.Ar,{showSidebar:t,children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-md",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx(r.Zb,{className:"w-full",children:s.jsx(r.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,s.jsxs)(o.qE,{className:"h-12 w-12",children:[s.jsx(o.F$,{src:e.profileImageUrl,alt:""}),s.jsx(o.Q5,{className:"text-sm",children:e.firstName?.[0]?.toUpperCase()||e.email?.[0]?.toUpperCase()||"U"})]}),(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"font-bold text-lg","data-testid":"text-user-display-name",children:e.firstName&&e.lastName?`${e.firstName} ${e.lastName}`:e.email}),s.jsx("p",{className:"text-sm text-muted-foreground",children:e.isAdmin?"Quản trị vi\xean":"Th\xe0nh vi\xean"}),(0,s.jsxs)("p",{className:"text-sm font-semibold text-emerald-600","data-testid":"text-user-balance-profile",children:["Số dư: ",Number(e.balance||0).toLocaleString("vi-VN"),"₫"]})]})]})})}),s.jsx(r.Zb,{className:"w-full",children:s.jsx(r.aY,{className:"p-0",children:(0,s.jsxs)("div",{className:"divide-y divide-border",children:[(0,s.jsxs)(g.default,{href:"/profile",className:"flex items-center space-x-3 px-4 py-4 hover:bg-accent transition-colors","data-testid":"link-profile",children:[s.jsx(x.Z,{className:"h-5 w-5 text-blue-500"}),s.jsx("span",{className:"font-medium",children:"Th\xf4ng tin c\xe1 nh\xe2n"})]}),(0,s.jsxs)(g.default,{href:"/purchased-tools",className:"flex items-center space-x-3 px-4 py-4 hover:bg-accent transition-colors","data-testid":"link-purchased-tools",children:[s.jsx("div",{className:"h-5 w-5 text-orange-500 flex items-center justify-center",children:"\uD83D\uDCE6"}),s.jsx("span",{className:"font-medium",children:"C\xf4ng cụ đ\xe3 mua"})]}),(0,s.jsxs)(g.default,{href:"/deposit",className:"flex items-center space-x-3 px-4 py-4 hover:bg-accent transition-colors","data-testid":"link-deposit",children:[s.jsx("div",{className:"h-5 w-5 text-gray-600 flex items-center justify-center",children:"\uD83D\uDCB3"}),s.jsx("span",{className:"font-medium",children:"Nạp tiền"})]}),(0,s.jsxs)(g.default,{href:"/history",className:"flex items-center space-x-3 px-4 py-4 hover:bg-accent transition-colors","data-testid":"link-history",children:[s.jsx("div",{className:"h-5 w-5 text-gray-600 flex items-center justify-center",children:"\uD83D\uDD52"}),s.jsx("span",{className:"font-medium",children:"Lịch sử"})]})]})})}),s.jsx(r.Zb,{className:"w-full",children:s.jsx(r.aY,{className:"pt-6",children:(0,s.jsxs)(l.z,{variant:"outline",className:"w-full",onClick:()=>y(!0),"data-testid":"button-edit-profile",children:[s.jsx(j,{className:"h-4 w-4 mr-2"}),"Chỉnh sửa th\xf4ng tin"]})})})]}),b&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)(r.Zb,{className:"w-full max-w-md max-h-[90vh] overflow-y-auto",children:[s.jsx(r.Ol,{children:s.jsx(r.ll,{children:"Chỉnh sửa th\xf4ng tin"})}),s.jsx(r.aY,{children:(0,s.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!P.trim()||!S.trim()){a({title:"Thiếu th\xf4ng tin",description:"Vui l\xf2ng nhập đầy đủ họ v\xe0 t\xean.",variant:"destructive"});return}L.mutate({firstName:P.trim(),lastName:S.trim(),email:D.trim()})},className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(d._,{htmlFor:"firstName",children:"Họ"}),s.jsx(c.I,{id:"firstName",value:P,onChange:e=>k(e.target.value),placeholder:"Nhập họ của bạn","data-testid":"input-first-name"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(d._,{htmlFor:"lastName",children:"T\xean"}),s.jsx(c.I,{id:"lastName",value:S,onChange:e=>_(e.target.value),placeholder:"Nhập t\xean của bạn","data-testid":"input-last-name"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx(d._,{htmlFor:"email",children:"Email"}),s.jsx(c.I,{id:"email",type:"email",value:D,onChange:e=>A(e.target.value),placeholder:"Nhập email của bạn","data-testid":"input-email"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(l.z,{type:"submit",disabled:L.isPending,className:"flex-1","data-testid":"button-save-profile",children:[s.jsx(v,{className:"h-4 w-4 mr-2"}),L.isPending?"Đang lưu...":"Lưu"]}),s.jsx(l.z,{type:"button",variant:"outline",onClick:()=>{k(e?.firstName||""),_(e?.lastName||""),A(e?.email||""),y(!1)},className:"flex-1","data-testid":"button-cancel-profile",children:"Hủy"})]})]})})]})})]})}):s.jsx(n.Ar,{showSidebar:t,children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"Vui l\xf2ng đăng nhập để xem th\xf4ng tin c\xe1 nh\xe2n."})})})})}},4094:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(9510);let i=(0,a(8570).createProxy)(String.raw`D:\TOOL\AutoHubWeb\frontend\src\features\profile\pages\Profile.tsx#default`);function n(){return s.jsx(i,{})}}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[561,918,539,230],()=>a(1085));module.exports=s})();